var dss=dss||{};$(function(){function e(e,a,t){return'<div class="alert alert-'+t+' alert-dismissible container" role="alert">              <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>              <strong>'+e+"</strong> "+a+"            </div>"}function a(){var e=$(".scroll-area"),a=e.offset();e.css("height",$(window).height()-a.top-20),t()}function t(){$("#result-modal .modal-dialog").css({width:parseInt($(".scroll-area").css("width")),"margin-top":"20px","margin-left":.5*($(window).width()-parseInt($(".scroll-area").css("width")))}),$("#result-modal .modal-body").css({height:.9*parseInt($(".scroll-area").css("height")),"overflow-y":"scroll","overflow-x":"hidden"})}$('input[type="number"]').on("change",function(){var e=parseFloat($(this).val()),a=parseFloat($(this).prop("min")),t=parseFloat($(this).prop("max"));$(this).val(e>t?t:a>e?a:e)}),$("#save").on("click",function(){var e=new Blob([JSON.stringify(dss.ui.model().model,null,2)],{type:"application/json"});saveAs(e,"solid-dss.json")}),$(".example-file").on("click",function(){var a=$(this).prop("id"),t=location.href.substr(0,location.href.lastIndexOf("/"))+"/examples/"+a+".json";$.ajax({type:"GET",url:t,dataType:"json",success:function(e){try{var a=e;"string"==typeof e&&(a=JSON.parse(a)),a.location&&r.fireEvent("click",{latlng:L.latLng(a.location.latitude,a.location.longitude)}),dss.ui.setModel(a)}catch(t){console.log(t)}},error:function(){$(e("","Could not load file '"+a+"'","warning")).prependTo($("body")).delay(6e3).fadeOut(500,function(){$(this).remove()})}})}),$("#load").on("change",function(a){var t=a.target.files.item(0),i=new FileReader;i.onload=function(a){var t=JSON.parse(a.target.result);t?(t.location&&r.fireEvent("click",{latlng:L.latLng(t.location.latitude,t.location.longitude)}),dss.ui.setModel(t)):$(e("Error.","Could not parse parameter file.","danger")).prependTo($("body")).delay(6e3).fadeOut(500,function(){$(this).remove()})},i.readAsText(t)});var r=new L.Map("map",{maxBounds:L.latLngBounds(L.latLng(35.375,-20.375),L.latLng(70.375,40.375))});L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors',maxZoom:9,minZoom:4}).addTo(r),r.setView([49.875,7.875],7),r.scrollWheelZoom.disable();navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var a=parseFloat(e.coords.latitude.toFixed(3)),t=parseFloat(e.coords.longitude.toFixed(3));$("#latitude").prop("value",a),$("#longitude").prop("value",t),r.setView([a,t],8),r.fireEvent("click",{latlng:L.latLng(a,t)})},function(e){console.log(e)});{var i=L.marker(null,{draggable:!1}).bindPopup('<div id="spinner"></div>',{className:"map-spinner",closeButton:!1});new Spinner}r.on("click",function(e){function a(e){g.push(e),4===g.length&&(4===g.reduce(function(e,a){return e+a})?(i.setPopupContent("<div>Weather data available</div>"),i.openPopup(),$("#latitude").prop("value",s),$("#longitude").prop("value",l)):(i.setPopupContent('<div style="color: rgb(222, 45, 38);">No weather data available.</div>'),i.openPopup()))}i.setLatLng(e.latlng).addTo(r);for(var t=e.latlng.lat,n=e.latlng.lng,o=[.125,.375,.625,.875],s=0,l=0,d=Number("0."+t.toFixed(3).split(".")[1]),p=Number("0."+n.toFixed(3).split(".")[1]),u=0|t,c=0|n,m=0;m<o.length;m++)Math.abs(o[m]-d)<=.125&&(s=Number(u.toString()+"."+o[m].toString().split(".")[1])),Math.abs(o[m]-p)<=.125&&(l=Number(c.toString()+"."+o[m].toString().split(".")[1]));var h=["https://zalf-lse.github.io/rr/rr_"+s+"_"+l+".json.gz","https://zalf-lse.github.io/tn/tn_"+s+"_"+l+".json.gz","https://zalf-lse.github.io/tg/tg_"+s+"_"+l+".json.gz","https://zalf-lse.github.io/tx/tx_"+s+"_"+l+".json.gz"],g=[];$.each(h,function(e,t){$.ajax({type:"HEAD",url:t,success:function(){a(1)},error:function(){a(0)}})})}),r.on("popupopen",function(){}),window.navigator.userAgent.indexOf("MSIE ")>=0&&$(e("","The application was tested with latest Chrome and Firefox browsers. <b>It may or may not work with IE</b>.","warning")).prependTo($("body")).delay(6e3).fadeOut(500,function(){$(this).remove()}),dss.ui={failedLP:function(e){$("#progress-dlg .modal-body").empty().html("<p>          The diet optimization in "+e.join(", ")+" failed.          </p>          <ul>          <li>Try to relax the RNB thresholds or try adding different energy and protein concentrates.</li>          <li>If there is a lack of dry matter (for each year only the feedstuff produced in the previous year is available) try to increase the forage availability from arable or grassland          or reduce the herd size. You can also test the reason of failure by increasing the straw limit in the diet.</li>          <li>There might be a lack of fibrous components in the diet.</li>          </ul>")},alert:e,progress:$("#progress-dlg").modal({show:!1}),results:$("#results-dlg").modal({show:!1}),map:r,model:function(){var e={location:{},soil:{},herd:{},feed:{},crop:{},rotation:{},grassland:{},fertilizer:{},simulation:{}},a={location:{},soil:{},herd:{},feed:{},crop:{},grassland:{},fertilizer:{},simulation:{}};return $(".parameter-location, .parameter-soil, .parameter-herd, .parameter-feed, .parameter-crop, .parameter-grassland, .parameter-fertilizer, .parameter-simulation").each(function(){var t=($(this).prop("id"),$(this).prop("min")),r=$(this).prop("max"),i=$(this).prop("type"),n=$(this).prop("tagName"),o="",s=$(this).prop("value");"TEXTAREA"!==n&&"text"!==i&&("SELECT"!==n||"No"!==s&&"Yes"!==s?"number"===i&&(s=parseFloat(s)):s="No"===s?!1:!0),0/0===s&&(s=0),$(this).hasClass("parameter-location")?o="location":$(this).hasClass("parameter-soil")?o="soil":$(this).hasClass("parameter-herd")?o="herd":$(this).hasClass("parameter-feed")?o="feed":$(this).hasClass("parameter-crop")?o="crop":$(this).hasClass("parameter-grassland")?o="grassland":$(this).hasClass("parameter-fertilizer")?o="fertilizer":$(this).hasClass("parameter-simulation")&&(o="simulation"),e[o][$(this).prop("id")]=s,a[o][$(this).prop("id")]={initialValue:s,type:typeof s,min:"number"==typeof s?parseFloat(t):t,max:"number"==typeof s?parseFloat(r):r}}),e.rotation=dss.ui.rotation.rotation(),{model:e,schema:a}},setModel:function(e){Object.keys(e).forEach(function(a){"rotation"===a?dss.ui.rotation.setRotation(e[a]):Object.keys(e[a]).forEach(function(t){var r=e[a][t];r="boolean"==typeof r?r?"Yes":"No":r,$("#"+t).prop("value",r)})})},milkYieldData:function(){var e=dss.ui.model().model,a="";if(0===e.herd["milk-yield-data"].trim().length)for(var t=dairy.milk.data[e.herd["milk-yield"]],r=0,i=t.length;i>r;r++)a+=Math.round(t[r][0]/7)+";"+t[r][1]+"\n";else a=e.herd["milk-yield-data"].trim();for(var n={t:[],y:[]},o=a.trim().split("\n"),s=o[0].indexOf(";")>0?";":"	",l=0,d=o.length;d>l;l++){var p=o[l].split(s);n.t[l]=parseFloat(p[0]),n.y[l]=parseFloat(p[1])}return n},charts:{results:{feedSurplus:c3.generate({bindto:"#feed-surplus-chart",data:{x:"x",columns:[],type:"bar",bar:{width:{ratio:.9}}},axis:{y:{show:!0,label:"[tonne DM / year]"}}}),intake:c3.generate({bindto:"#intake-chart",data:{x:"x",columns:[]},axis:{x:{type:"timeseries",tick:{format:"%Y/%m",values:["1995-06-01","1996-06-01","1997-06-01","1998-06-01","1999-06-01","2000-06-01","2001-06-01","2002-06-01","2003-06-01","2004-06-01","2005-06-01","2006-06-01","2007-06-01","2008-06-01","2009-06-01","2010-06-01","2011-06-01","2012-06-01","2013-06-01"]}},y:{show:!0,label:"[kg DM / cow]"}},point:{show:!1}}),diet:[],dietBudget:[],water:c3.generate({bindto:"#water-chart",data:{x:"x",xFormat:"%Y-%m-%d",columns:[],axes:{irrigation:"y2","water deficit":"y","nitrogen deficit":"y"},types:{irrigation:"bar"}},bar:{width:{ratio:.1}},axis:{x:{type:"timeseries",tick:{format:"%Y/%m",values:["1995-06-01","1996-06-01","1997-06-01","1998-06-01","1999-06-01","2000-06-01","2001-06-01","2002-06-01","2003-06-01","2004-06-01","2005-06-01","2006-06-01","2007-06-01","2008-06-01","2009-06-01","2010-06-01","2011-06-01","2012-06-01","2013-06-01"]}},y:{show:!0,label:"[stress index]"},y2:{show:!0,label:"[mm]"}},regions:[],point:{show:!1}}),"yield":c3.generate({bindto:"#yield-chart",data:{x:"x",columns:[],type:"bar"},bar:{width:{ratio:.5}},axis:{y:{show:!0,label:"[kg DM / ha]"}},regions:[],point:{show:!1}})},weather:c3.generate({bindto:"#weather-chart-1",data:{x:"x",xFormat:"%Y-%m-%d",columns:[],names:{precipitation:"precipitation monthly sum",temperature:"mean temperature monthly average",radiation:"global radiation monthly average",daylength:"daylength monthly average"},axes:{precipitation:"y",temperature:"y2",radiation:"y2",daylength:"y2"},type:"bar",types:{temperature:"spline",radiation:"spline",daylength:"spline"}},bar:{width:{ratio:.2}},axis:{x:{type:"timeseries",tick:{format:"%Y/%m",values:["1995-06-01","1996-06-01","1997-06-01","1998-06-01","1999-06-01","2000-06-01","2001-06-01","2002-06-01","2003-06-01","2004-06-01","2005-06-01","2006-06-01","2007-06-01","2008-06-01","2009-06-01","2010-06-01","2011-06-01","2012-06-01","2013-06-01"]}},y:{show:!0,label:"[mm]"},y2:{show:!0,label:"[MJ m-2 & h & Â°C]"}},grid:{y:{lines:[{value:0}]}},tooltip:{format:{value:function(e){return e.toFixed(1)}}},point:{show:!1}}),arable:c3.generate({bindto:"#arable-chart-1",data:{columns:[],type:"pie"},pie:{expand:!1}}),area:c3.generate({bindto:"#area-chart-1",data:{columns:[],type:"pie"},pie:{expand:!1}}),wood:c3.generate({bindto:"#dairy-chart-1",data:{x:"x",columns:[["x"],["fit"],["data"]],type:"line",names:{fit:"lactation curve (fitted)",data:"milk yield data"}},axis:{x:{label:"[week]"},y:{label:"[kg milk]"}},tooltip:{format:{value:function(e){return e.toFixed(1)}}}}),herd:c3.generate({bindto:"#dairy-chart-2",data:{columns:[["parity1",0],["parity2",0],["parity3",0]],type:"bar",names:{parity1:"Parity 1",parity2:"Parity 2",parity3:"Parity >2"}},bar:{width:{ratio:.2}},axis:{y:{label:"no. animals"}}}),requirements:c3.generate({bindto:"#dairy-chart-3",data:{columns:[],type:"bar",axes:{Energy:"y",Protein:"y2"}},bar:{width:{ratio:.2}},axis:{x:{type:"category",categories:["Group 1","Group 2","Group 3"]},y:{show:!0,label:"Energy"},y2:{show:!0,label:"Protein"}}})},rotation:new CropRotationUi("#crop-rotation",{crops:[{name:"wheat",isPerennial:!1,parameter:{"N-input":{name:"Nitrogen input",unit:"kg N / ha",help:"Average mineral or organic nitrogen fertilization",value:80,min:0,max:200},irrigation:{name:"Irrrigated",unit:"-",help:"Apply automatic irrigation",value:["No","Yes"]}}},{name:"grass-legume",isPerennial:!0,parameter:{"N-input":{name:"Nitrogen input",unit:"kg N / ha",help:"Average mineral or organic nitrogen fertilization",value:80,min:0,max:200},irrigation:{name:"Irrrigated",unit:"-",help:"Apply automatic irrigation",value:["No","Yes"]},"legume-share":{name:"Legume share",unit:"%",help:"Initial legume share of total DM",min:1,max:100,value:20}}},{name:"maize-silage",isPerennial:!1,parameter:{"N-input":{name:"Nitrogen input",unit:"kg N / ha",help:"Average mineral or organic nitrogen fertilization",value:80,min:0,max:200},irrigation:{name:"Irrrigated",unit:"-",help:"Apply automatic irrigation",value:["Yes","No"]}}},{name:"barley",isPerennial:!1,parameter:{"N-input":{name:"Nitrogen input",unit:"kg N / ha",help:"Average mineral or organic nitrogen fertilization",value:80,min:0,max:200},irrigation:{name:"Irrrigated",unit:"-",help:"Apply automatic irrigation",value:["No","Yes"]}}},{name:"oats",isPerennial:!1,parameter:{"N-input":{name:"Nitrogen input",unit:"kg N / ha",help:"Average mineral or organic nitrogen fertilization",value:80,min:0,max:200},irrigation:{name:"Irrrigated",unit:"-",help:"Apply automatic irrigation",value:["No","Yes"]}}},{name:"rye",isPerennial:!1,parameter:{"N-input":{name:"Nitrogen input",unit:"kg N / ha",help:"Average mineral or organic nitrogen fertilization",value:80,min:0,max:200},irrigation:{name:"Irrrigated",unit:"-",help:"Apply automatic irrigation",value:["No","Yes"]}}}],colors:["rgb(8,81,156)","rgb(0,109,44)","rgb(210, 210, 5)","rgb(203, 24, 29)","rgb(204, 76, 2)","rgb(106, 81, 163)","rgb(206, 18, 86)","rgb(164, 46, 46)","rgb(107,174,214)","rgb(35,139,69)"],maxRotationLength:5},function(e){var a=!0,t=parseInt($("#arable-area").val()),r=e.isPerennial?", perennial":"",i=a?dss.ui.rotation.rotationLength():1,t=(e.area*t/i).toFixed(2),n=e.name+r+", "+(isNaN(t)?0:t)+" ha "+(a?"each year":"");$("#crop-rotation > #edit").empty(),$("#crop-rotation > #edit").append('<div class="text col-lg-12" style="margin-bottom:5px;"><h4>'+n+"</h4></div>");var o=$("<div class='col-md-4'>").appendTo($("#crop-rotation > #edit")),s=$("<div class='col-md-4'>").appendTo($("#crop-rotation > #edit")),l=$("<div class='col-md-4'>").appendTo($("#crop-rotation > #edit")),d=1;for(prop in e.parameter)if(e.parameter.hasOwnProperty(prop)){var p=e.parameter[prop];if(Array.isArray(p.value)){var u=p.value.reduce(function(e,a){return e+'<option value="'+a+'">'+a+"</option>\n"},"");$('<label for="'+prop+'">'+p.name+'</label>              <div class="input-group">                <select id="'+prop+'" type="number" data-toggle="popover" data-placement="bottom" class="form-control" data-content="'+p.help+'">                '+u+'                 </select>                <span class="input-group-addon">'+p.unit+"</span>              </div>              <br>").appendTo(1===d?o:2===d?s:l)}else $('<label for="'+prop+'">'+p.name+'</label>              <div class="input-group">                <input id="'+prop+'" type="number" data-toggle="popover" data-placement="bottom" class="form-control" value="'+p.value+'" min="'+p.min+'" max="'+p.max+'" data-content="'+p.help+'">                <span class="input-group-addon">'+p.unit+"</span>              </div>              <br>").appendTo(1===d?o:2===d?s:l);3===d?d=1:d++}$('#crop-rotation > #edit [data-toggle="popover"]').popover({trigger:"hover"}),$("#crop-rotation > #edit select").change(function(){var a=e.parameter[$(this).attr("id")].value;Array.isArray(a)&&(a.splice(a.indexOf($(this).val())),a.unshift($(this).val()))}),$("#crop-rotation > #edit input").change(function(){if("number"===$(this).prop("type")){var a=parseFloat($(this).val()),t=parseFloat($(this).prop("min")),r=parseFloat($(this).prop("max"));value=a>r?r:t>a?t:a,$(this).val(value)}e.parameter[$(this).attr("id")].value=$(this).val()})})},dss.ui.rotation.setRotation([[{crop:{name:"wheat",isPerennial:!1,parameter:{},area:1},id:1450209252741,to:[1450209252749,1450209252753]}],[{crop:{name:"rye",isPerennial:!1,parameter:{},area:.5},id:1450209252749,to:[1450209252757]},{crop:{name:"barley",isPerennial:!1,parameter:{},area:.5},id:1450209252753,to:[1450209252761]}],[{crop:{name:"grass-legume",isPerennial:!0,parameter:{},area:.5},id:1450209252757,to:[1450209268399]},{crop:{name:"rye",isPerennial:!1,parameter:{},area:.5},id:1450209252761,to:[1450209269988]}],[{crop:{name:"grass-legume",isPerennial:!0,parameter:{},area:.5},id:1450209268399,to:[1450209252741]},{crop:{name:"maize-silage",isPerennial:!1,parameter:{},area:.5},id:1450209269988,to:[1450209252741]}]]),$(".scroll-area").scrollspy({target:"#navbar"}),$("#navbar").on("activate.bs.scrollspy",function(){var e="intro"!==$("#navbar li.active > a").prop("href").split("#")[1];$("#navbar li img").toggleClass("inflate",e,0),$("#title").toggleClass("deflate",e,0)}),$("#weather-charts").bind("inview",function(e,a){a&&dss.fn.updateWeather()}),$("#crop-charts").bind("inview",function(a,t,r,i){if(t&&("bottom"==i||"both"==i)){if(!dss.ui.rotation.rotationIsValid())return void $(e("Error.","Crop rotation is not valid.","danger")).prependTo($("body")).delay(6e3).fadeOut(500,function(){$(this).remove()});var n=dss.ui.rotation.rotation().reduce(function(e,a){for(var t=0;t<a.length;t++){var r=e.filter(function(e){return e[0]===a[t].crop.name})[0];r?r[r.length-1]+=a[t].crop.area:e.push([a[t].crop.name,a[t].crop.area])}return e},[]);dss.ui.charts.arable.load({columns:n});var o=dss.ui.model().model;dss.ui.charts.area.load({columns:[["permanent grassland w/o pasture",o.grassland["grassland-area"]*(1-o.grassland["pasture-share"]/100)/(o.crop["arable-area"]+o.grassland["grassland-area"])],["arable land",o.crop["arable-area"]/(o.crop["arable-area"]+o.grassland["grassland-area"])],["pasture",o.grassland["grassland-area"]*o.grassland["pasture-share"]/100/(o.crop["arable-area"]+o.grassland["grassland-area"])]]})}}),$("#dairy-chart-1").bind("inview",function(e,a,t,r){if(a&&("bottom"==r||"both"==r)){if(!dss.fn.modelChanged("feed",["eval-system"])&&!dss.fn.modelChanged("herd")&&dss.ui.charts.wood.data().length>0)return;var i=((new Spinner).spin($("#dairy-chart-1")[0]),(new Spinner).spin($("#dairy-chart-3")[0]),dss.ui.milkYieldData());dss.fn.fitWood(i,function(e){if("object"==typeof e){for(var a=[["x"],["fit"],["data"]],t=0,r=i.t.length;r>t;t++)a[0].push(i.t[t]),a[1].push(dss.fn.wood(i.t[t],e)),a[2].push((i.t[t],i.y[t]));dss.ui.charts.wood.load({columns:a}),dss.fn.herdStructure(),dss.fn.cowProperties(),dss.fn.groupCowsForTMRfeeding();var n=dss.fn.getAverageTMRcows(),o=dss.ui.model().model.feed["eval-system"],s=[],a=n.nonDry.reduce(function(e,a,t){return e[0].push(Math.round(a.req[o].total.E)),e[1].push(Math.round(a.req.de.total.P)),s.push("Group "+(t+1)),e},[["Energy"],["Protein"]]);dss.ui.charts.requirements.axis.labels({y:"Energy ["+("de"===o?"MJ NEL":"fr"===o?"UFL":"MJ ME")+" / cow]",y2:"Protein [g uCP]"}),dss.ui.charts.requirements.load({columns:a,categories:s}),$("#dairy-chart-1 .spinner").remove(),$("#dairy-chart-3 .spinner").remove(),dss.fn.updateModel("herd"),dss.fn.updateModel("feed",["eval-system"])}})}}),$("#dairy-chart-2").bind("inview",function(e,a,t,r){if(a&&("bottom"==r||"both"==r)){if(!dss.fn.modelChanged("herd",["age-first-calving","female-calves-rate","still-birth-rate","young-stock-cull-rate","replacement-rate","calving-interval","herd-size","dry-periode"]))return;{(new Spinner).spin($("#dairy-chart-2")[0])}dss.fn.herdStructure(function(e){dss.ui.charts.herd.load({columns:[e[0],e[1],e[2]]}),$("#dairy-chart-2 .spinner").remove(),dss.fn.updateModel("herd",["age-first-calving","female-calves-rate","still-birth-rate","young-stock-cull-rate","replacement-rate","calving-interval","herd-size","dry-periode"])})}});var n=dairy.feed.feeds.reduce(function(e,a){return"concentrate"===a.type&&e.push(a),e},[]),o=n.reduce(function(e,a){if(60===a.id){var t=JSON.parse(JSON.stringify(a));t.id=500+e.length,t.name="Custom concentrate",e.push(t)}return e},[]);n.sort(function(e,a){var t=e.name.toLowerCase(),r=a.name.toLowerCase();return r>t?-1:t>r?1:0}),n=n.concat(o);for(var s=0,l=n.length;l>s;s++)for(var d=n[s],p=[53,57].indexOf(d.id)>-1?1:0,u=s%2>0?"#feed-accordion-2":"#feed-accordion-1",c=d.id,m=d.name,h=d.type,g=[{value:d.name,unit:"-",name:"Name",help:"Feed name"},{value:p,unit:"t FM / year",name:"Amount",help:"Maximum total amount fed per year in tonnes"},{value:d.DM,unit:"g / kg FM",name:"DM",help:"Dry matter content in fresh matter"},{value:d.OM,unit:"g / kg DM",name:"OM",help:"Organic matter content in dry matter."},{value:Math.round(100*d.OMD),unit:"%",name:"OMD",help:"Organic matter digestibility."},{value:d.CP,unit:"g / kg DM",name:"CP",help:"Crude protein content in dry matter."},{value:Math.round(100*d.CPD),unit:"%",name:"CPD",help:"Crude protein digestibility."},{value:d.EE,unit:"g / kg DM",name:"EE",help:"Ether extract content in dry matter."},{value:Math.round(100*d.EED),unit:"%",name:"EED",help:"Ether extract digestibility."},{value:d.CF,unit:"g / kg DM",name:"CF",help:"Crude fibre content in dry matter."},{value:Math.round(100*d.CFD),unit:"%",name:"CFD",help:"Crude fibre digestibility."},{value:d.NFE,unit:"g / kg DM",name:"NFE",help:"Nitrogenfree extractives in dry matter."},{value:Math.round(100*d.NFED),unit:"%",name:"NFED",help:"Nitrogenfree extractives digestibility."}],f=function(){5===$(".feed-selected").length&&parseFloat($(this).prop("value"))>0&&$(e("Suggestion.","Select at most five feeds. Otherwise the diet optimization problem might become too large.","warning")).prependTo($("body")).delay(6e3).fadeOut(500,function(){$(this).remove()});var a=parseFloat($(this).prop("value"));!isNaN(a)&&a>0?$(this).parents(".panel").find("a").addClass("feed-selected"):$(this).parents(".panel").find("a").removeClass("feed-selected")},v=$('<div class="panel panel-default">        <div class="panel-heading" role="tab" id="heading-'+c+'">          <h4 class="panel-title">            <a class="'+(p>0?"feed-selected":"")+'" data-toggle="collapse" data-parent="'+u+'" href="#feed-'+c+'" aria-expanded="false" aria-controls="feed-'+c+'">              '+m+'            </a>          </h4>        </div>        <div id="feed-'+c+'" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-'+c+'" data-dss-feed-type="'+h+'">          <div class="panel-body">          </div>        </div>      </div>').appendTo($(u)).find(".panel-body"),y=0,b=g.length;b>y;y++){var x="",w="",h="number";"Name"===g[y].name&&(500>c&&(x="disabled",w='style="display:none;"'),h="text"),v.append('<div class="input-group" '+w+'>          <span class="input-group-addon">'+g[y].name+'</span>            <input id="feed-'+c+"-"+g[y].name.toLowerCase()+'" type="'+h+'" data-toggle="popover" data-placement="bottom" class="form-control parameter-feed" value="'+g[y].value+'" min="0" data-content="'+g[y].help+'" '+x+'>          <span class="input-group-addon">'+g[y].unit+"</span>        </div>"+(""===w?"<br>":"")),"amount"===g[y].name.toLowerCase()&&$("#feed-"+c+"-"+g[y].name.toLowerCase()).change(f)}$('[data-toggle="popover"]').popover({trigger:"hover"}),$(window).resize(function(){a()}),a(),$("#run-btn,#run-link").click(function(){return!dss.ui.rotation.rotationIsValid()||dss.ui.rotation.rotationLength()<4?void $(e("Error.","Crop rotation is not valid or too short (minimum 4 years)","danger")).prependTo($("body")).delay(6e3).fadeOut(500,function(){$(this).remove()}):void dss.fn.runModel(function(){})})});